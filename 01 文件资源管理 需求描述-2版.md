[TOC]

# 文件资源管理 需求描述

## 01、用户登录、注册

**用户登录 - 功能描述：**

用户通过用户名和密码登录到文件管理系统

1. 用户在确认自己已经注册的情况下，通过输入用户名和密码，进入系统
   - 需要验证码
   - 如果用户名或密码出错，则显示出错界面
3. 为了防止非法用户暴力破解，添加了验证码功能
4. 为了防止非法用户不经过用户名密码的输入就访问后台资源，添加了过滤器功能

**用户注册 - 功能描述：**

用户通过个人信息，注册成为本系统的用户

1. 任何用户都可以注册成为本系统的用户
   - 用户提交个人信息
     - 姓名
     - 邮箱
     - 密码
     - 确认密码（页面认证，不存储）
2. 邮箱验证（向注册邮箱发送邮件，指定验证链接）
   - 生成验证地址（一次注册，一个验证地址；验证有效期15min）
   - 发送邮件
     - 异常：邮件发送失败（用户的邮箱不合法）
3. 邮箱验证异常
   - 验证地址失效
   - 异常处理
     - 提示验证地址失效，重新注册
     - 数据库删除注册失败的用户信息

【用户状态迁移过程】

## 02、文件获取与展示

**获取文件(夹)列表 - 功能描述：**

列出指定文件夹中的文件(夹)

1. 前置条件：用户成功登录
2. 异常情况
   - 没有文件夹的查看权限
   - 请求超时
   - 指定的文件夹不存在

**文件(夹)列表展示 - 功能描述：**

展示指定文件夹中的文件(夹)

1. 文件展示
   - 展示数据
     - Name，Size，Last modified属性
     - 标签信息
   - 展示方式
     - 列表展示
     - 图标展示
2. 附加功能
   - 文件列表排序

## 03、文件列表排序

**文件(夹)排序 - 功能描述：**

对列表中文件（夹）进行排序。

1. 所有目录默认按Name属性排序
2. 排序依据：
   - Name，Size，Last modified属性
     - Name属性排序(按英文【A-Z】、中文【A-Z】、数字【0-9】顺序)
     - Size属性排序(按文件大小顺序)
     - Last modified属性(按最后修改时间与当下时间间隔的长短顺序)
3. 排序方式：
   - 递增排序
   - 递减排序
4. 排序限制：
   - 选择的排序方法仅对当前目录有效
   - 文件和文件夹分开排序
     - 文件夹在列表中的显示优先于文件
5. 扩展需求
   - 文件Size或Last modified属性相同时，按照Name属性进行二次排序

## 04、文件搜索

**文件直接搜索 - 功能描述：**

根据输入的关键字搜索出与其相关的文件(夹)。

1. 输入关键字根据文件命名规则进行合法性验证
2. 关键字可以是后缀名
3. 搜索关键字不需要完全匹配到文件名
   - 搜索到的文件或者文件夹中应该包含且连续的关键字
4. 点击搜索框显示历史搜索记录（记录可选；清除记录用户可选）
   - 可以有历史记录供用户选择
   - 提供清除记录选项
5. 搜索异常
   - 搜索关键字不合法（SQL语句、非法字符等等）**防注入**，提示异常，用户修改关键字
   - 文件名格式不规范，用户重新输入或者修改
   - 如果用户点击搜索按钮无反应，需要给出异常原因
   - 输入为空，无操作。

**文件高级搜索-功能描述：**

用户可以通过筛选功能，根据文件或文件夹拥有的属性设置其对应限制加上关键字多条件搜索，显示出其相关的文件或文件夹。

1. 高级搜索的属性值合法性进行检查
   - 文件限制条件（默认：无限制；大小[单选,下限为0，上限给选择]；类型[多选]；**标签**[多选]；文件的修改时间）

## 05、新建文件、文件夹

**新建文件(夹)-功能描述:**

输入文件(夹)名称，新建指定的文件(夹)，

1. 文件名称
   - 文件新建时默认名称“新建文件”+<后缀>
   - 文件夹创建时默认名称"新建文件夹"
   - 如果已经存在"新建文件（夹）"就加上序号（（1），（2）...）
2. 文件类型限制
   - 输入名称后，默认类型为无（即新建文件夹）
   - 新建文件时的后缀名，有限可选（少于系统支持的所有文件类型）
3. 文件(夹)名称限制
   - 名称合法性
     - 特殊字符限制：文件名或文件夹名中不能出现以下字符：\、/、:、*、?、"、<、>、| 等
   - 名称长度限制
4. 新建文件(夹)的默认目录为用户当前目录
5. 新建文件(夹)的异常
   - 重复命名，两个选择：一是提示是否替换；二是添加一个“副本”标识。
   - 命名不合法，给出对应的提示
   - 因为网络问题创建失败需要提示用户稍后操作或者重试

## 06、上传文件、文件夹

**上传文件(夹) - 功能描述：**

上传文件(夹)到指定的文件夹。

1. 获取需要上传的文件路径
2. 选择需要上传的文件
   - 选择单个文件
   - 选择多个文件
   - 选择文件夹（读取路径下的文件，仅上传文件）
4. 文件上传限制

   - 文件名限制（文件名不存在特殊符号，符合命名规范）
   - 上传文件大小限制（可上传的单个文件大小，一次性可上传的总文件大小）
   - 上传文件数量限制（一次性可上传文件的数量）
   - 上传文件格式限制（可上传的文件格式）
   - 不允许上传文件夹
5. 压缩文件的上传

   - 当成一个文件处理（不考虑压缩文件内部的文件类型）
- 上传之后不解压
5. 文件上传异常

   - 文件已存在

     - 覆盖已有文件

     - 默认重命名（“xxx - 副本”、“xxx - 副本 (2)”）
   - 文件过大、文件数量过多、文件格式不允许
   - 文件上传中断（网络拥塞等）
   - 指定文件夹不允许上传
6. 文件上传扩展需求

   - 文件尺寸超过4MB，分块上传加快上传速度
   - 从网络上获取文件并存储于文件系统中
7. 显示上传进度，上传完成有提示

## 07、下载文件、文件夹

下载并保存文件（夹）到指定位置

1. 选择需要下载的文件

   - 选择单个文件
   - 选择多个文件
   - 选择文件夹

2. 文件下载限制

   - 下载权限限制，共享文件（夹）指定的所有用户都可下载
   - 单次下载文件数量限制（批量下载上限）

3. 选择下载文件的存储路径（指定文件夹）

4. 用户可以选择暂停/开始下载

   - 显示下载进度，下载完成有提示

5. 用户可以选择取消下载

   - 再次确认删除操作

   - 保留已下载成功的文件

   - 删除下载列表未完成的下载任务

6. 文件下载异常

   - 文件权限不允许下载（提示权限不足）
   - 文件下载数量过多（提示减少下载的文件总数）
   - 文件下载中断（网络故障等）
     - 断点续传

   - 文件下载失败（无法获取下载地址）
     - 重新下载
     - 下载文件不存在

## 08、移动文件、文件夹

**移动文件(夹) - 功能描述：**

将文件(夹)从当前目录移动到指定目录

1. 选中需要移动的文件

   - 选择单个文件
   - 选择多个文件
   - 选择文件夹

2. 移动

   * “剪切”选中的文件
     * 剪切文件限制：移动完成之前，当前文件(夹)不可操作
   * “粘贴”到目的文件夹（粘贴成功后删除原文件）

3. 暂停/开始移动

   * 显示移动进度，点击按钮可以暂停/开始移动，移动完成有提示

4. 取消移动

   - 移动多个文件时，取消操作，只取消没有移动成功的文件

     （移动成功的文件在目的文件夹，未完成移动的文件在原路径）

5. 移动文件异常

   - 无文件移动权限（提示权限不足，文件不允许移动）
   - 目的文件夹权限不允许移入文件（提示权限不足，移入的文件夹不允许修改）
   - 文件名重复（目的文件夹已存在同名的文件）
     - 覆盖已有文件
     - 默认重命名

## 09、拷贝文件、文件夹

**拷贝文件(夹) - 功能描述：**

将文件(夹)从当前目录拷贝到指定目录

1. 选中需要拷贝的文件
   - 选择单个文件
   - 选择多个文件
   - 选择文件夹
2. 拷贝
   * “复制”选中的文件
     * 复制文件限制：拷贝完成之前，当前文件(夹)不可操作
   * “粘贴”到目的文件夹（粘贴成功后保留原文件）
3. 暂停/开始拷贝
   * 显示拷贝进度，点击按钮可以暂停/开始拷贝，拷贝完成有提示
4. 取消粘贴
   - 拷贝多个文件，取消操作时，只取消没有粘贴成功的文件
5. 拷贝文件异常
   - 无文件拷贝权限（提示权限不足，文件不允许拷贝）
   - 目的文件夹权限不允许移入文件（提示权限不足，移入的文件夹不允许修改）
   - 文件名重复（目的文件夹已存在同名的文件）
     - 覆盖已有文件
     - 默认重命名

## 10、删除文件、文件夹

**删除文件(夹) - 功能描述：**

删除指定文件夹下的文件(夹)；同时删除对应文件(夹)的所有标签。

1. 用户确认删除文件的操作

   - 删除单个文件

   - 删除多个文件

   - 删除文件夹
2. 文件删除限制

   - 文件权限限制（选中文件不允许删除，权限不满足）

   - 删除文件(夹)，同时删除对应文件(夹)的标签

3. 文件删除异常

   - 目标文件正在被使用
   - 目标文件不存在
   - 删除文件权限不满足（提示权限不足，指定文件夹下不允许普通权限用户删除文件）
4. 删除操作不可撤销

## 11、分享文件、文件夹

**分享文件(夹) - 功能描述：**

分享指定的文件(夹)。

1. 选择文件(夹)，确认分享

   - 设置分享期限（1天、7天、永久）
   - 生成分享链接和提取密码
   - 复制分享链接和提取密码

2. 管理我的分享

   - 查看分享详情

   - 可以取消分享
   - 复制链接及密码

3. 文件分享限制

   - 仅分享文件(夹)，不包含标签信息
   - 原文件删除或改变路径，分享自动取消，分享链接失效

4. 文件分享异常

   - 没有文件分享权限（提示权限不足）

## 12、提取分享文件

**提取分享文件(夹) - 功能描述：**

根据分享链接和提取密码，提取分享的文件(夹)。

1. 查看分享的内容

2. 选中需要提取的文件

   - 选择单个文件
   - 选择多个文件
   - 选择文件夹

3. 提取选中的文件

   - 下载文件到本地
   - 保存到文件系统的指定文件夹

4. 文件提取限制

   - 下载到本地
     - 下载文件数量限制（批量下载上限）
   - 保存到文件系统
     - 文件名限制（文件名不存在特殊符号，符合命名规范）
     - 保存文件大小限制（可保存的单个文件大小，一次性可保存的总文件大小）
     - 保存文件数量限制（一次性可保存文件的数量）

5. 文件提取异常

   - 分享链接失效
     - 超出分享有效期
     - 分享文件不存在
   - 提取密码不正确（提示重新输入密码）
   - 下载到本地异常

     - 文件下载数量过多（提示减少下载的文件总数）
     - 文件下载中断（网络故障等）
       + 下载自动暂停，网络恢复后续传  （接续下载，记录下载中断的位置）
     - 文件下载失败（无法获取下载地址）

       - 重新下载
   - 保存到文件系统异常

     - 文件名重复、不合法
     - 文件过大、文件数量过多
     - 文件保存中断（网络拥塞等）
     - 指定文件夹不允许保存

6. 文件提取成功提示

   - 下载成功提示
   - 保存成功提示

## 13、给文件(夹)添加/删除标签

**添加标签 - 功能描述：**

给指定的文件(夹)添加和内容相关的标签

1. 标签来源

   - 选择系统已有标签

   - 用户自定义新的标签
     - 新定义的标签不允许和已有标签重复

2. 每个文件(夹)可以添加多个标签

   - 多个标签不允许重复

3. 添加标签的限制

   - 名称的合法性
   - 标签长度限制
   - 标签个数限制【单个文件(夹)】
   - 权限限制：目标文件(夹)不允许添加标签

4. 添加标签的异常

   - 名称不合法
     - 特殊字符
     - 重复
     - 长度超出限制
   - 标签个数超限【单个文件(夹)】
   - 权限不满足



**删除标签 - 功能描述：**

删除指定文件(夹)上的指定标签

1. 选取需要删除标签的文件(夹)
2. 删除指定标签
3. 删除标签限制
   - 权限限制
4. 删除标签异常
   - 无权限
   - 标签不存在

## 14、文件(夹)重命名

**文件(夹)重命名 - 功能描述：**

修改指定文件(夹)的名称。

1. 修改的限制
   - 指定的文件(夹)不允许修改
2. 修改的异常
   - 文件(夹)名称重复、不合法
   - 无权限修改文件(夹)名称

## 15、共享文件夹

**共享文件夹 - 功能描述：**

支持多个用户共同管理文件(夹)。

1. 新建共享
   - 新建共享文件夹
     - 设置文件夹名称
   - 选择现有的文件夹共享
   - 设置共享文件夹权限
     - 设置共享成员管理权限（新建、上传、下载、移动、拷贝、删除、修改、分享、标签设置、文件访问权限）
     - 限制文件夹内文件类型
   - 生成共享文件夹链接
2. 加入共享
   - 用户点击链接加入共享
   - 异常
     - 共享链接失效，无法加入共享
3. 查看创建的共享
   - 操作共享文件夹(拥有所有权限)
   - 管理我的共享
     - 权限设置
     - 取消共享
     - 查看共享详情
       - 操作记录：操作者、操作对象、操作时间
       - 共享成员、群组
4. 查看加入的共享

   - 操作共享文件夹(拥有部分权限)
     - 异常：没有相应操作权限（提示权限不足）
   - 查看共享详情
     - 操作记录：操作者、操作对象、操作时间
     - 共享成员、群组

## 16、用户存储空间

**用户存储空间 - 功能描述：**

1. 分配用户存储空间
   - 前提条件：用户成功注册
   - 分配存储空间(默认大小)
2. 删除\上传\转存\复制文件，已用\可用空间检测
3. 用户注销，删除对应用户所有存储空间
4. 删除\上传\转存\复制文件，检测存储空间容量是否充足

## 17、用户注销

**用户注销 - 功能描述：**

1. 用户自主注销
2. 注销后
   - 用户不可访问系统内所有数据信息
   - 限期可以找回账号
3. 注销时，需要输入个人用户密码确认
4. 注销后再登录
   - 找回账号的有效期内：提示用户账号已注销，是否找回
   - 找回账号的有效期已过：提示用户账号已注销